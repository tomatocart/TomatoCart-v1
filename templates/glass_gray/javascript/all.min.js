var popDialog=new Class({Implements:[Options],options:{clsEl:"dialog",enableAnimation:true,baseClsAnimated:"animated",clsAnimated:"bounceInDown",clsClose:"btnClose",clsHideAnimation:"slideOutUp"},initialize:function(b,a){this.setOptions(a);this.dlg=this.createDialog(b);this.currentClsAnimated=this.options.clsAnimated;this.showed=false},show:function(){if(this.showed){if(this.options.enableAnimation===true){this.dlg.removeClass(this.options.clsAnimated);this.dlg.removeClass(this.currentClsAnimated)}this.dlg.setStyle("display","block");this.setPosition();if(this.options.enableAnimation===true){this.dlg.addClass(this.options.clsAnimated)}}else{$(document.body).adopt(this.dlg);this.setPosition();if(this.options.enableAnimation===true){this.dlg.addClass(this.options.baseClsAnimated);this.dlg.addClass(this.options.clsAnimated)}this.showed=true}},setPosition:function(){var g=window,c="inner",b,d,f;if(!("innerWidth" in window)){c="client";g=document.documentElement||document.body}b={width:g[c+"Width"],height:g[c+"Height"]};f=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;d=this.dlg.getSize();this.dlg.setStyles({left:((b.width/2-d.x/2)+"px"),top:((b.height/2-d.y/2+f)+"px")})},createDialog:function(a){var b;if(typeof a!="undefined"){b=new Element("div",{"class":this.options.clsEl,html:a,styles:{position:"absolute"}});return b}return null},doAnimate:function(a){if(a&&(a!=this.options.clsAnimated)){this.dlg.removeClass(this.options.clsAnimated);this.dlg.addClass(a);this.currentClsAnimated=a}},hide:function(){this.dlg.setStyle("display","none")},update:function(a){this.dlg.set("html",a)},destroy:function(){this.dlg.destroy()}});var Autocompleter=new Class({Implements:[Options,Events],options:{minLength:1,markQuery:true,width:330,maxChoices:10,injectChoice:null,customChoices:null,emptyChoices:null,visibleChoices:true,className:"autocompleter-choices",zIndex:42,delay:400,observerOptions:{},fxOptions:{},autoSubmit:false,overflow:false,overflowMargin:25,selectFirst:false,filter:null,filterCase:false,filterSubset:false,forceSelect:false,selectMode:true,choicesMatch:null,multiple:false,separator:", ",separatorSplit:/\s*[,;]\s*/,autoTrim:false,allowDupes:false,cache:true,relative:false},initialize:function(b,a){this.element=$(b);this.setOptions(a);this.build();this.observer=new Observer(this.element,this.prefetch.bind(this),$merge({delay:this.options.delay},this.options.observerOptions));this.queryValue=null;if(this.options.filter){this.filter=this.options.filter.bind(this)}var c=this.options.selectMode;this.typeAhead=(c=="type-ahead");this.selectMode=(c===true)?"selection":c;this.cached=[]},build:function(){if($(this.options.customChoices)){this.choices=this.options.customChoices}else{this.choices=new Element("ul",{"class":this.options.className,styles:{zIndex:this.options.zIndex}}).inject(document.body);this.relative=false;if(this.options.relative){this.choices.inject(this.element,"after");this.relative=this.element.getOffsetParent()}this.fix=new OverlayFix(this.choices)}if(!this.options.separator.test(this.options.separatorSplit)){this.options.separatorSplit=this.options.separator}this.fx=(!this.options.fxOptions)?null:new Fx.Tween(this.choices,$merge({property:"opacity",link:"cancel",duration:200},this.options.fxOptions)).addEvent("onStart",Chain.prototype.clearChain).set(0);this.element.setProperty("autocomplete","off").addEvent((Browser.Engine.trident||Browser.Engine.webkit)?"keydown":"keypress",this.onCommand.bind(this)).addEvent("click",this.onCommand.bind(this,[false])).addEvent("focus",this.toggleFocus.create({bind:this,arguments:true,delay:100})).addEvent("blur",this.toggleFocus.create({bind:this,arguments:false,delay:100}))},destroy:function(){if(this.fix){this.fix.destroy()}this.choices=this.selected=this.choices.destroy()},toggleFocus:function(a){this.focussed=a;if(!a){this.hideChoices(true)}this.fireEvent((a)?"onFocus":"onBlur",[this.element])},onCommand:function(b){if(!b&&this.focussed){return this.prefetch()}if(b&&b.key&&!b.shift){switch(b.key){case"enter":if(this.element.value!=this.opted){return true}if(this.selected&&this.visible){this.choiceSelect(this.selected);return !!(this.options.autoSubmit)}break;case"up":case"down":if(!this.prefetch()&&this.queryValue!==null){var a=(b.key=="up");this.choiceOver((this.selected||this.choices)[(this.selected)?((a)?"getPrevious":"getNext"):((a)?"getLast":"getFirst")](this.options.choicesMatch),true)}return false;case"esc":case"tab":this.hideChoices(true);break}}return true},setSelection:function(f){var g=this.selected.inputValue,h=g;var a=this.queryValue.length,c=g.length;if(g.substr(0,a).toLowerCase()!=this.queryValue.toLowerCase()){a=0}if(this.options.multiple){var e=this.options.separatorSplit;h=this.element.value;a+=this.queryIndex;c+=this.queryIndex;var b=h.substr(this.queryIndex).split(e,1)[0];h=h.substr(0,this.queryIndex)+g+h.substr(this.queryIndex+b.length);if(f){var d=h.split(this.options.separatorSplit).filter(function(j){return this.test(j)},/[^\s,]+/);if(!this.options.allowDupes){d=[].combine(d)}var i=this.options.separator;h=d.join(i)+i;c=h.length}}this.observer.setValue(h);this.opted=h;if(f||this.selectMode=="pick"){a=c}this.element.selectRange(a,c);this.fireEvent("onSelection",[this.element,this.selected,h,g])},showChoices:function(){var c=this.options.choicesMatch,b=this.choices.getFirst(c);this.selected=this.selectedValue=null;if(this.fix){var e=this.element.getCoordinates(this.relative),a=this.options.width||"auto";this.choices.setStyles({left:e.left,top:e.bottom,width:(a===true||a=="inherit")?e.width:a})}if(!b){return}if(!this.visible){this.visible=true;this.choices.setStyle("display","");if(this.fx){this.fx.start(1)}this.fireEvent("onShow",[this.element,this.choices])}if(this.options.selectFirst||this.typeAhead||b.inputValue==this.queryValue){this.choiceOver(b,this.typeAhead)}var d=this.choices.getChildren(c),f=this.options.maxChoices;var i={overflowY:"hidden",height:""};this.overflown=false;if(d.length>f){var j=d[f-1];i.overflowY="scroll";i.height=j.getCoordinates(this.choices).bottom;this.overflown=true}this.choices.setStyles(i);this.fix.show();if(this.options.visibleChoices){var h=document.getScroll(),k=document.getSize(),g=this.choices.getCoordinates();if(g.right>h.x+k.x){h.x=g.right-k.x}if(g.bottom>h.y+k.y){h.y=g.bottom-k.y}window.scrollTo(Math.min(h.x,g.left),Math.min(h.y,g.top))}},hideChoices:function(a){if(a){var c=this.element.value;if(this.options.forceSelect){c=this.opted}if(this.options.autoTrim){c=c.split(this.options.separatorSplit).filter($arguments(0)).join(this.options.separator)}this.observer.setValue(c)}if(!this.visible){return}this.visible=false;if(this.selected){this.selected.removeClass("autocompleter-selected")}this.observer.clear();var b=function(){this.choices.setStyle("display","none");this.fix.hide()}.bind(this);if(this.fx){this.fx.start(0).chain(b)}else{b()}this.fireEvent("onHide",[this.element,this.choices])},prefetch:function(){var f=this.element.value,e=f;if(this.options.multiple){var c=this.options.separatorSplit;var a=f.split(c);var b=this.element.getSelectedRange().start;var g=f.substr(0,b).split(c);var d=g.length-1;b-=g[d].length;e=a[d]}if(e.length<this.options.minLength){this.hideChoices()}else{if(e===this.queryValue||(this.visible&&e==this.selectedValue)){if(this.visible){return false}this.showChoices()}else{this.queryValue=e;this.queryIndex=b;if(!this.fetchCached()){this.query()}}}return true},fetchCached:function(){return false;if(!this.options.cache||!this.cached||!this.cached.length||this.cached.length>=this.options.maxChoices||this.queryValue){return false}this.update(this.filter(this.cached));return true},update:function(b){this.choices.empty();this.cached=b;var a=b&&$type(b);if(!a||(a=="array"&&!b.length)||(a=="hash"&&!b.getLength())){(this.options.emptyChoices||this.hideChoices).call(this)}else{if(this.options.maxChoices<b.length&&!this.options.overflow){b.length=this.options.maxChoices}b.each(this.options.injectChoice||function(d){var c=new Element("li",{html:this.markQueryValue(d)});c.inputValue=d;this.addChoiceEvents(c).inject(this.choices)},this);this.showChoices()}},choiceOver:function(c,d){if(!c||c==this.selected){return}if(this.selected){this.selected.removeClass("autocompleter-selected")}this.selected=c.addClass("autocompleter-selected");this.fireEvent("onSelect",[this.element,this.selected,d]);if(!this.selectMode){this.opted=this.element.value}if(!d){return}this.selectedValue=this.selected.inputValue;if(this.overflown){var f=this.selected.getCoordinates(this.choices),e=this.options.overflowMargin,g=this.choices.scrollTop,a=this.choices.offsetHeight,b=g+a;if(f.top-e<g&&g){this.choices.scrollTop=Math.max(f.top-e,0)}else{if(f.bottom+e>b){this.choices.scrollTop=Math.min(f.bottom-a+e,b)}}}if(this.selectMode){this.setSelection()}},choiceSelect:function(a){if(a){this.choiceOver(a)}this.setSelection(true);this.queryValue=false;this.hideChoices()},filter:function(a){return(a||this.tokens).filter(function(b){return this.test(b)},new RegExp(((this.options.filterSubset)?"":"^")+this.queryValue.escapeRegExp(),(this.options.filterCase)?"":"i"))},markQueryValue:function(a){return(!this.options.markQuery||!this.queryValue)?a:a.replace(new RegExp("("+((this.options.filterSubset)?"":"^")+this.queryValue.escapeRegExp()+")",(this.options.filterCase)?"":"i"),'<span class="autocompleter-queried">$1</span>')},addChoiceEvents:function(a){return a.addEvents({mouseover:this.choiceOver.bind(this,[a]),click:this.choiceSelect.bind(this,[a])})}});var OverlayFix=new Class({initialize:function(a){if(Browser.Engine.trident){this.element=$(a);this.relative=this.element.getOffsetParent();this.fix=new Element("iframe",{frameborder:"0",scrolling:"no",src:"javascript:false;",styles:{position:"absolute",border:"none",display:"none",filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}}).inject(this.element,"after")}},show:function(){if(this.fix){var a=this.element.getCoordinates(this.relative);delete a.right;delete a.bottom;this.fix.setStyles($extend(a,{display:"",zIndex:(this.element.getStyle("zIndex")||1)-1}))}return this},hide:function(){if(this.fix){this.fix.setStyle("display","none")}return this},destroy:function(){if(this.fix){this.fix=this.fix.destroy()}}});Element.implement({getSelectedRange:function(){if(!Browser.Engine.trident){return{start:this.selectionStart,end:this.selectionEnd}}var e={start:0,end:0};var a=this.getDocument().selection.createRange();if(!a||a.parentElement()!=this){return e}var c=a.duplicate();if(this.type=="text"){e.start=0-c.moveStart("character",-100000);e.end=e.start+a.text.length}else{var b=this.value;var d=b.length-b.match(/[\n\r]*$/)[0].length;c.moveToElementText(this);c.setEndPoint("StartToEnd",a);e.end=d-c.text.length;c.setEndPoint("StartToStart",a);e.start=d-c.text.length}return e},selectRange:function(d,a){if(Browser.Engine.trident){var c=this.value.substr(d,a-d).replace(/\r/g,"").length;d=this.value.substr(0,d).replace(/\r/g,"").length;var b=this.createTextRange();b.collapse(true);b.moveEnd("character",d+c);b.moveStart("character",d);b.select()}else{this.focus();this.setSelectionRange(d,a)}return this}});Autocompleter.Base=Autocompleter;Autocompleter.Request=new Class({Extends:Autocompleter,options:{postData:{},ajaxOptions:{},postVar:"value"},query:function(){var c=$unlink(this.options.postData)||{};c[this.options.postVar]=this.queryValue;var b=$(this.options.indicator);if(b){b.setStyle("display","")}var a=this.options.indicatorClass;if(a){this.element.addClass(a)}this.fireEvent("onRequest",[this.element,this.request,c,this.queryValue]);this.request.send({data:c})},queryResponse:function(){var b=$(this.options.indicator);if(b){b.setStyle("display","none")}var a=this.options.indicatorClass;if(a){this.element.removeClass(a)}return this.fireEvent("onComplete",[this.element,this.request])}});Autocompleter.Request.JSON=new Class({Extends:Autocompleter.Request,initialize:function(c,b,a){this.parent(c,a);this.request=new Request.JSON($merge({url:b,link:"cancel"},this.options.ajaxOptions)).addEvent("onComplete",this.queryResponse.bind(this))},queryResponse:function(a){this.parent();this.update(a)}});Autocompleter.Request.HTML=new Class({Extends:Autocompleter.Request,initialize:function(c,b,a){this.parent(c,a);this.request=new Request.HTML($merge({url:b,link:"cancel",update:this.choices},this.options.ajaxOptions)).addEvent("onComplete",this.queryResponse.bind(this))},queryResponse:function(a,b){this.parent();if(!b||!b.length){this.hideChoices()}else{this.choices.getChildren(this.options.choicesMatch).each(this.options.injectChoice||function(c){var d=c.innerHTML;c.inputValue=d;this.addChoiceEvents(c.set("html",this.markQueryValue(d)))},this);this.showChoices()}}});Autocompleter.Ajax={Base:Autocompleter.Request,Json:Autocompleter.Request.JSON,Xhtml:Autocompleter.Request.HTML};var Observer=new Class({Implements:[Options,Events],options:{periodical:false,delay:1000},initialize:function(c,a,b){this.element=$(c)||$$(c);this.addEvent("onFired",a);this.setOptions(b);this.bound=this.changed.bind(this);this.resume()},changed:function(){var a=this.element.get("value");if($equals(this.value,a)){return}this.clear();this.value=a;this.timeout=this.onFired.delay(this.options.delay,this)},setValue:function(a){this.value=a;this.element.set("value",a);return this.clear()},onFired:function(){this.fireEvent("onFired",[this.value,this.element])},clear:function(){$clear(this.timeout||null);return this},pause:function(){if(this.timer){$clear(this.timer)}else{this.element.removeEvent("keyup",this.bound)}return this.clear()},resume:function(){this.value=this.element.get("value");if(this.options.periodical){this.timer=this.changed.periodical(this.options.periodical,this)}else{this.element.addEvent("keyup",this.bound)}return this}});var $equals=function(b,a){return(b==a||JSON.encode(b)==JSON.encode(a))};var TocAutoCompleter=new Class({Extends:Autocompleter.Request.JSON,options:{remoteUrl:"json.php",sessionName:"sid",sessionId:null,postData:{module:"auto_completer",action:"get_products"},minLength:3,filterSubset:true,cache:true,delay:0,imageGroup:"thumbnail",moreBtnText:"Get More"},initialize:function(b,a){this.options.postVar=b;this.parent(b,this.options.remoteUrl,a);this.options.postData[this.options.sessionName]=this.options.sessionId;if(a.template){this.options.postData.template=a.template}},showChoices:function(){if(this.options.imageGroup=="thumbnail"){this.choices.addClass("useThumbnail")}var f=this.options.choicesMatch,d=this.choices.getFirst(f);this.selected=this.selectedValue=null;if(this.fix){var h=this.element.getCoordinates(this.relative),e=this.element.getSize(),b;if(this.options.width){this.choices.setStyle("width",this.options.width+"px")}b=this.choices.getSize();if(!this.relative){this.relative=b.x-e.x||e.x-b.x}this.choices.setStyles({left:h.left-this.relative,top:h.bottom});this.choices.addEvent("mouseleave",function(){this.hideChoices()}.bind(this))}if(!d){return}if(!this.visible){this.visible=true;this.choices.setStyle("display","");if(this.fx){this.fx.start(1)}this.fireEvent("onShow",[this.element,this.choices])}if(this.options.selectFirst||this.typeAhead||d.inputValue==this.queryValue){this.choiceOver(d,this.typeAhead)}var g=this.choices.getChildren(f),i=this.options.maxChoices;var m={overflowY:"hidden",height:""};this.overflown=false;if(g.length>i){var l=g[i-1];m.overflowY="scroll";m.height=l.getCoordinates(this.choices).bottom;this.overflown=true}this.choices.setStyles(m);this.fix.show();if(this.options.visibleChoices){var k=document.getScroll(),n=document.getSize(),j=this.choices.getCoordinates();if(j.right>k.x+n.x){k.x=j.right-n.x}if(j.bottom>k.y+n.y){k.y=j.bottom-n.y}window.scrollTo(Math.min(k.x,j.left),Math.min(k.y,j.top))}if(this.choices.getElement("div.more")===null){var c=new Element("div",{"class":"more"}),a=new Element("a",{href:"#","class":"button squre medium btn",html:this.options.moreBtnText});this.choices.adopt(c);c.adopt(a);a.addEvent("click",function(o){o.stop();this.element.getParent("form").submit();return false}.bind(this))}},update:function(b){this.choices.empty();this.cached=b;var a=b&&$type(b);if(!a||(a=="array"&&!b.length)||(a=="hash"&&!b.getLength())){(this.options.emptyChoices||this.hideChoices).call(this)}else{if(this.options.maxChoices<b.length&&!this.options.overflow){b.length=this.options.maxChoices}b.each(this.options.injectChoice||function(e){var d=new Element("li",{html:e,"class":"clearfix"}),f=d.getElement("a"),g=f.get("text"),c=this.markQueryValue(g);d.inputValue=g;f.set("html",c);this.addChoiceEvents(d).inject(this.choices)},this);this.showChoices()}},markQueryValue:function(b){var a=(!this.options.markQuery||!this.queryValue)?b:b.replace(new RegExp("("+((this.options.filterSubset)?"":"^")+this.queryValue.escapeRegExp()+")",(this.options.filterCase)?"":"i"),'<span class="autocompleter-queried">$1</span>');return a},query:function(){this.element.removeClass("auto-loaded").addClass("auto-loading");this.parent()},queryResponse:function(a){this.parent(a);this.element.removeClass("auto-loading").addClass("auto-loaded")},choiceSelect:function(a){var b=a.getElement("a");this.parent(a);window.location=b.getProperty("href")}});var PopupCart=new Class({Implements:[Options],options:{remoteUrl:"json.php",sessionName:"sid",sessionId:null,isCartExpanded:false,triggerEl:$("popupCart"),container:$("pageHeader"),itemsEl:$("popupCartItems"),clsCollapsed:"cartCallpased",clsExpanded:"cartExpanded",clsCartText:"cartText",contentEl:$("pageContent")||$("content-center"),enableDelete:"yes",enableFlyEffect:true,clsAddBtn:".ajaxAddToCart",clsImage:".productImage",dlgConfirmStatus:true},initialize:function(a){this.setOptions(a);this.registerEvents()},registerEvents:function(){this.options.triggerEl.addEvents({mouseover:function(a){a.stop();if(this.options.isCartExpanded==false){this.getShoppingCart();$$("."+this.options.clsCartText).each(function(b){if(b.hasClass(this.options.clsCollapsed)){b.removeClass(this.options.clsCollapsed)}b.addClass(this.options.clsExpanded)}.bind(this))}}.bind(this)});if(this.options.enableDelete==="no"){this.options.enableFlyEffect=false}if(this.options.enableFlyEffect==true){this.enableFlyingEffects()}},getShoppingCart:function(){var a={action:"get_cart_contents",enable_delete:this.options.enableDelete};this.sendRequest(a,function(b){this.displayCart(b)}.bind(this))},displayCart:function(b){var a=JSON.decode(b),f=this.options.triggerEl.getCoordinates(),c,d,e;if(a.success==true){if(!$defined(this.cartContainer)){this.cartContainer=new Element("div",{html:a.content,id:"popupCartContent",styles:{position:"absolute",opacity:0}});this.cartContainer.addEvent("mouseleave",function(g){g.stop();d.start(1,0);this.options.isCartExpanded=false;$$("."+this.options.clsCartText).each(function(h){if(h.hasClass(this.options.clsExpanded)){h.removeClass(this.options.clsExpanded)}h.addClass(this.options.clsCollapsed)}.bind(this))}.bind(this))}else{this.cartContainer.set("html",a.content)}this.options.container.adopt(this.cartContainer);c=this.cartContainer.getCoordinates();this.cartContainer.setStyles({left:f.left-(c.width-f.width),top:f.top+(f.height/5)});d=new Fx.Tween(this.cartContainer,{duration:100,link:"cancel",property:"opacity"});d.start(0,1);if(this.options.enableDelete=="yes"){e=this.cartContainer.getElements(".removeBtn");if(e.length>0){e.each(function(g){g.addEvent("click",function(i){i.stop();var h=g.get("data-pid");this.removeProduct(h,g);return false}.bind(this))},this)}this.options.itemsEl.set("text",a.total)}this.options.isCartExpanded=true}},enableFlyingEffects:function(){if(this.options.contentEl){this.options.contentEl.addEvent("click:relay("+this.options.clsAddBtn+")",function(h){var k=h.target;h.stop();if(k.hasClass("disabled")){return false}k.set("disabled","disabled");var j=[],f=k.get("id"),g="";if(f.test("^ac_[a-z]+_[0-9]+$","i")){var l=f.split("_").getLast();var m=null;var i=$$(".variantCombobox select");var d=$$(".variants_"+l+" select");if(i.length>0){m=i}else{if(d.length>0){m=d}}if(m!==null){m.each(function(e){var o=e.id.toString();var n=o.substring(9,o.indexOf("]"));g+=n+":"+e.value+";"}.bind(this))}}else{if(f.test("^ac_[a-z]+_[0-9]+(?:#(?:[0-9]+:?[0-9]+)+(?:;?(?:[0-9]+:?[0-9]+)+)*)*$","i")){var a=f.split("_").getLast(),c=a.split("#"),l=c[0],g=c[1]}}var b={action:"add_product",pID:l};if($defined($("quantity"))){b.pQty=$("quantity").get("value")}if($("qty_"+l)!=null){b.pQty=$("qty_"+l).get("value")}if(g){b.variants=g}if($defined($("senders_name"))&&$("senders_name").value!=""){b.senders_name=$("senders_name").value}else{if($defined($("senders_name"))&&$("senders_name").value==""){j.push(this.options.error_sender_name_empty)}}if($defined($("senders_email"))&&$("senders_email").value!=""){b.senders_email=$("senders_email").value}else{if($defined($("senders_email"))&&$("senders_email").value==""){j.push(this.options.error_sender_email_empty)}}if($defined($("recipients_name"))&&$("recipients_name").value!=""){b.recipients_name=$("recipients_name").value}else{if($defined($("recipients_name"))&&$("recipients_name").value==""){j.push(this.options.error_recipient_name_empty)}}if($defined($("recipients_email"))&&$("recipients_email").value!=""){b.recipients_email=$("recipients_email").value}else{if($defined($("recipients_email"))&&$("recipients_email").value==""){j.push(this.options.error_recipient_email_empty)}}if($defined($("message"))&&$("message").value!=""){b.message=$("message").value}else{if($defined($("message"))&&$("message").value==""){j.push(this.options.error_message_empty)}}if($defined($("gift_certificate_amount"))&&$("gift_certificate_amount").value!=""){b.gift_certificate_amount=$("gift_certificate_amount").value}else{if($defined($("gift_certificate_amount"))&&$("gift_certificate_amount").value==""){j.push(this.options.error_message_open_gift_certificate_amount)}}if(j.length>0){alert(j.join("\n"));k.erase("disabled");return false}this.sendRequest(b,function(n){var e=JSON.decode(n);if(e.success==true){this.doFlyingEffects(k,e.items);if(this.options.dlgConfirmStatus==true){this.showConfirmation(e.confirm_dialog)}}else{k.erase("disabled")}}.bind(this));return false}.bind(this))}},doFlyingEffects:function(b,a){var e=$(document.body),g=b.closest(this.options.clsImage),d=g.getCoordinates(),f=g.clone().setStyles({position:"absolute",width:d.width,height:d.height,left:d.left,top:d.top,"z-index":9999}),c=this.options.triggerEl.getCoordinates();e.adopt(f);f.set("morph",{duration:300,onComplete:function(){f.fade("out");(function(){f.destroy()}).delay(500);b.erase("disabled");this.options.itemsEl.set("text",a)}.bind(this)}).morph({width:d.width/4,height:d.height/4,top:c.top,left:c.left})},removeProduct:function(f,c){var a,b=c.getParent("tr"),e=c.getParent("table").getNext("table"),d={action:"remove_product",pID:f};this.sendRequest(d,function(g){a=JSON.decode(g);if(a.success){b.addClass("animated slideOutUp");(function(){b.destroy()}).delay(300);this.options.itemsEl.set("text",a.total);e.set("html",a.order_totals)}}.bind(this))},showConfirmation:function(a){if(a!=null){if(typeof this.dlg!=="undefined"){this.dlg.update(a)}else{this.dlg=new popDialog(a)}this.dlg.show();if($("btnContinue")!=null){$("btnContinue").addEvent("click",function(b){b.stop();this.dlg.doAnimate("slideOutUp");this.dlg.hide();return false}.bind(this))}}},sendRequest:function(c,d){var a={template:this.options.template,module:"popup_cart",method:"post"};a[this.options.sessionName]=this.options.sessionId;$extend(a,c);var b=new Request({url:this.options.remoteUrl,data:a,onSuccess:d.bind(this)}).send()}});var TocBookmark=new Class({Implements:[Options],options:{title:document.title,url:window.location.href},initialize:function(a){this.setOptions(a);var d=$(this.options.bookmark);var c=new Element("a");var b=new Element("img",{title:this.options.text,src:this.options.img});if(window.opera&&window.print){c.setProperties({href:this.options.url,title:this.options.title,rel:"sidebar"})}else{c.setStyle("cursor","pointer")}c.appendChild(b);c.appendText(this.options.text);d.appendChild(c);c.addEvent("click",function(){this.onBookmarkClicked()}.bind(this))},onBookmarkClicked:function(){if(window.sidebar){window.sidebar.addPanel(this.options.title,this.options.url,"")}else{if(document.all){window.external.AddFavorite(this.options.url,this.options.title)}}if(window.opera&&window.print){alert("Press ctrl+D to bookmark (Command+D for macs) after you click Ok")}else{if(window.chrome){alert("Press ctrl+D to bookmark (Command+D for macs) after you click Ok")}}}});